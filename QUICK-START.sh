#!/usr/bin/env bash

# ============================================================================
# SEEDBAY QUICK START GUIDE
# 28 janvier 2026
# ============================================================================

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸš€ SEEDBAY - QUICK START GUIDE"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# COLORS
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

echo -e "${BLUE}ğŸ“‹ FICHIERS DISPONIBLES:${NC}"
echo ""
echo -e "${GREEN}â–¶ DOCUMENTATION COMPLÃˆTE (Lire dans cet ordre):${NC}"
echo "  1. SEEDBAY-README.md                  â­ START HERE (20 min)"
echo "  2. LIVRABLES-INDEX.md                 Index des fichiers (20 min)"
echo "  3. POINTS-CRITIQUES.md                Checklist sÃ©curitÃ© (15 min)"
echo "  4. seedbay-auth-security.js           Flows & menaces (30 min)"
echo "  5. seedbay-executive-summary.ts       Architecture (30 min)"
echo "  6. seedbay-security.sql               Schema SQL (45 min)"
echo "  7. seedbay-deployment-guide.ts        Deployment (45 min)"
echo "  8. seedbay-threats-roadmap.ts         Risques & roadmap (30 min)"
echo ""

echo -e "${GREEN}â–¶ CODE SOURCE Ã€ UTILISER (Copy-paste dans votre projet):${NC}"
echo "  9.  seedbay-middleware.ts             â†’ src/middleware.ts"
echo " 10.  seedbay-auth-lib.ts               â†’ src/lib/auth.ts"
echo " 11.  seedbay-signup-route.ts           â†’ src/app/api/auth/signup/route.ts"
echo " 12.  seedbay-create-order-route.ts     â†’ src/app/api/orders/create-intent/route.ts"
echo " 13.  seedbay-webhook-route.ts          â†’ src/app/api/payments/webhook/route.ts âš ï¸"
echo ""

echo -e "${GREEN}â–¶ TESTS DE SÃ‰CURITÃ‰:${NC}"
echo " 14.  seedbay-security-tests.ts         56 test cases (30 min)"
echo ""

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Menu interactif
echo -e "${YELLOW}Que voulez-vous faire?${NC}"
echo ""
echo "1) ğŸ“–  Lire la documentation"
echo "2) ğŸ’» ImplÃ©menter le code"
echo "3) ğŸ§ª Tester la sÃ©curitÃ©"
echo "4) ğŸš€ DÃ©ployer en production"
echo "5) ğŸ“‹ Voir la checklist complÃ¨te"
echo "6) âŒ Quitter"
echo ""
read -p "Choisissez (1-6): " choice

case $choice in
  1)
    echo ""
    echo -e "${BLUE}ğŸ“– PHASE 1: DOCUMENTATION${NC}"
    echo ""
    echo "Lire dans cet ordre (2-3 heures):"
    echo ""
    echo -e "${GREEN}1. SEEDBAY-README.md${NC}"
    echo "   â””â”€ Vue d'ensemble, architecture, checklist"
    echo ""
    echo -e "${GREEN}2. POINTS-CRITIQUES.md${NC}"
    echo "   â””â”€ Points Ã  NE PAS OUBLIER"
    echo ""
    echo -e "${GREEN}3. seedbay-auth-security.js${NC}"
    echo "   â””â”€ Flows d'authentification, menaces, dÃ©fenses"
    echo ""
    echo -e "${GREEN}4. seedbay-executive-summary.ts${NC}"
    echo "   â””â”€ Architecture technique dÃ©taillÃ©e"
    echo ""
    echo -e "${GREEN}5. seedbay-deployment-guide.ts${NC}"
    echo "   â””â”€ Comment dÃ©ployer en production"
    echo ""
    echo "AprÃ¨s avoir lu: passez Ã  l'Ã©tape 2 (ImplÃ©menter)"
    echo ""
    ;;
  2)
    echo ""
    echo -e "${BLUE}ğŸ’» PHASE 2: IMPLÃ‰MENTATION (1 SEMAINE)${NC}"
    echo ""
    echo -e "${GREEN}JOUR 1-2: Setup Infrastructure${NC}"
    echo "  1. CrÃ©er un projet Supabase (https://supabase.com)"
    echo "  2. CrÃ©er un compte Stripe (https://stripe.com)"
    echo "  3. CrÃ©er un projet Vercel (https://vercel.com)"
    echo "  4. CrÃ©er un repo Git (GitHub)"
    echo ""
    echo -e "${GREEN}JOUR 2: ExÃ©cuter le Schema SQL${NC}"
    echo "  1. Copier le contenu de seedbay-security.sql"
    echo "  2. Aller sur Supabase â†’ SQL Editor"
    echo "  3. Coller et exÃ©cuter (ğŸŸ¢ APPLY)"
    echo "  4. VÃ©rifier que RLS est activÃ©:"
    echo "     SELECT * FROM information_schema.tables"
    echo "     WHERE row_security_level IS NOT NULL"
    echo ""
    echo -e "${GREEN}JOUR 3: Copier le Code Source${NC}"
    echo "  1. Initialiser Next.js project: npx create-next-app@latest"
    echo "  2. Installer dÃ©pendances:"
    echo "     npm install @supabase/supabase-js stripe zod jose"
    echo ""
    echo "  3. Copier les fichiers:"
    echo "     - seedbay-middleware.ts â†’ src/middleware.ts"
    echo "     - seedbay-auth-lib.ts â†’ src/lib/auth.ts"
    echo "     - seedbay-signup-route.ts â†’ src/app/api/auth/signup/route.ts"
    echo "     - seedbay-create-order-route.ts â†’ src/app/api/orders/create-intent/route.ts"
    echo "     - seedbay-webhook-route.ts â†’ src/app/api/payments/webhook/route.ts"
    echo ""
    echo "  4. Configurer .env:"
    echo "     NEXT_PUBLIC_SUPABASE_URL=https://[project].supabase.co"
    echo "     NEXT_PUBLIC_SUPABASE_ANON_KEY=[anon-key]"
    echo "     SUPABASE_JWT_SECRET=[jwt-secret]"
    echo "     STRIPE_SECRET_KEY=<stripe-secret>"
    echo "     STRIPE_WEBHOOK_SECRET=<stripe-webhook-secret>"
    echo ""
    echo -e "${GREEN}JOUR 4-5: Frontend Pages${NC}"
    echo "  - Page d'accueil"
    echo "  - Marketplace (listing des projets)"
    echo "  - DÃ©tail d'un projet"
    echo "  - Checkout (Stripe Elements)"
    echo "  - Dashboard vendeur"
    echo "  - Dashboard acheteur"
    echo ""
    echo -e "${GREEN}JOUR 6: Tester${NC}"
    echo "  - npm run test:security (56 test cases)"
    echo "  - VÃ©rifier tous les tests passent"
    echo ""
    echo -e "${GREEN}JOUR 7: DÃ©ployer${NC}"
    echo "  - Staging deployment sur Vercel"
    echo "  - Tests finaux"
    echo "  - Production deployment"
    echo ""
    ;;
  3)
    echo ""
    echo -e "${BLUE}ğŸ§ª PHASE 3: TESTS DE SÃ‰CURITÃ‰${NC}"
    echo ""
    echo "Avant production, tester les 56 cas:"
    echo ""
    echo -e "${GREEN}1. AUTHENTICATION (6 tests)${NC}"
    echo "   - Signup avec email invalide"
    echo "   - Signup avec password faible"
    echo "   - Email verification flow"
    echo "   - Login incorrect"
    echo "   - JWT expiration"
    echo "   - JWT modification"
    echo ""
    echo -e "${GREEN}2. AUTHORIZATION (7 tests)${NC}"
    echo "   - Buyer voir projets publiÃ©s"
    echo "   - Vendor voir ses projets"
    echo "   - Admin voir tous les projets"
    echo "   - Vendor ne peut pas Ã©diter projet d'autres"
    echo "   - Etc."
    echo ""
    echo -e "${GREEN}3. PAYMENTS (10 tests)${NC}"
    echo "   - CrÃ©er commande"
    echo "   - Email verification required"
    echo "   - Achat unique"
    echo "   - Webhook forgery"
    echo "   - Montant vÃ©rifiÃ©"
    echo "   - Etc."
    echo ""
    echo -e "${GREEN}4. FILES (8 tests)${NC}"
    echo "   - Owner voir fichiers"
    echo "   - Buyer non-propriÃ©taire = pas d'accÃ¨s"
    echo "   - Signed URL expiration"
    echo "   - Etc."
    echo ""
    echo "Voir seedbay-security-tests.ts pour tous les tests"
    echo ""
    echo -e "${YELLOW}âš ï¸  TOUS LES TESTS DOIVENT PASSER AVANT PRODUCTION!${NC}"
    echo ""
    ;;
  4)
    echo ""
    echo -e "${BLUE}ğŸš€ PHASE 4: DÃ‰PLOIEMENT PRODUCTION${NC}"
    echo ""
    echo -e "${GREEN}JOUR 1: PrÃ©-dÃ©ploiement${NC}"
    echo "  âœ“ Lire seedbay-deployment-guide.ts complÃ¨tement"
    echo "  âœ“ VÃ©rifier checklist sÃ©curitÃ©"
    echo "  âœ“ Database backups crÃ©Ã©"
    echo "  âœ“ Stripe webhook configurÃ©"
    echo "  âœ“ Vercel environment variables OK"
    echo ""
    echo -e "${GREEN}JOUR 2: Staging${NC}"
    echo "  1. CrÃ©er Vercel preview deployment"
    echo "  2. Tester transaction complÃ¨te"
    echo "  3. Tester avec Stripe test keys"
    echo "  4. Monitorer logs pendant 2h"
    echo ""
    echo -e "${GREEN}JOUR 3: Production${NC}"
    echo "  1. Git push â†’ Vercel auto-deploys (~2 min)"
    echo "  2. VÃ©rifier health endpoint"
    echo "  3. Tester critical paths"
    echo "  4. Monitorer Sentry + logs"
    echo ""
    echo -e "${GREEN}JOUR 4+: Monitoring${NC}"
    echo "  - VÃ©rifier paiements complÃ©tÃ©s"
    echo "  - VÃ©rifier downloads fonctionnent"
    echo "  - Analyser metrics de performance"
    echo "  - PrÃªt pour marketing!"
    echo ""
    echo -e "${YELLOW}CHECKLIST FINALE:${NC}"
    echo "  [ ] Tous les 56 tests PASSED"
    echo "  [ ] Aucun error dans Sentry"
    echo "  [ ] Performance < 200ms p99"
    echo "  [ ] Uptime 100% pendant 24h"
    echo "  [ ] 10+ transactions rÃ©ussies"
    echo "  [ ] Monitoring configurÃ©"
    echo ""
    echo -e "${GREEN}âœ… Vous Ãªtes prÃªt Ã  lancer!${NC}"
    echo ""
    ;;
  5)
    echo ""
    echo -e "${BLUE}ğŸ“‹ CHECKLIST COMPLÃˆTE${NC}"
    echo ""
    echo -e "${YELLOW}SÃ‰CURITÃ‰ (CRITICAL):${NC}"
    echo "  [ ] Lire POINTS-CRITIQUES.md"
    echo "  [ ] Aucun secret en plaintext"
    echo "  [ ] .env.local dans .gitignore"
    echo "  [ ] RLS activÃ© sur TOUTES les tables"
    echo "  [ ] Webhook Stripe signature validÃ©e"
    echo "  [ ] SELECT seulement colonnes nÃ©cessaires"
    echo "  [ ] Zod validation sur tous les POST/PATCH"
    echo ""
    echo -e "${YELLOW}DATABASE:${NC}"
    echo "  [ ] SQL schema exÃ©cutÃ©"
    echo "  [ ] Backups configurÃ©s (daily)"
    echo "  [ ] Connection pooling setup"
    echo "  [ ] RLS policies testÃ©es"
    echo ""
    echo -e "${YELLOW}STRIPE:${NC}"
    echo "  [ ] Compte production crÃ©Ã©"
    echo "  [ ] 2FA activÃ©e"
    echo "  [ ] Webhook configurÃ© + secret copiÃ©"
    echo "  [ ] Test webhook: stripe trigger"
    echo ""
    echo -e "${YELLOW}FRONTEND:${NC}"
    echo "  [ ] Helmet.js pour headers"
    echo "  [ ] CORS configurÃ©"
    echo "  [ ] CSP header"
    echo "  [ ] HTTPS enforced"
    echo ""
    echo -e "${YELLOW}MONITORING:${NC}"
    echo "  [ ] Sentry intÃ©grÃ©"
    echo "  [ ] Alertes configurÃ©es"
    echo "  [ ] Logs queryable"
    echo ""
    echo -e "${YELLOW}TESTING:${NC}"
    echo "  [ ] 56/56 tests passed"
    echo "  [ ] Load testing OK"
    echo "  [ ] Security audit OK"
    echo ""
    ;;
  6)
    echo ""
    echo -e "${GREEN}Ã€ bientÃ´t! ğŸ‘‹${NC}"
    echo ""
    exit 0
    ;;
  *)
    echo -e "${RED}Option invalide${NC}"
    ;;
esac

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo -e "${GREEN}âœ… SEEDBAY EST PRÃŠT POUR ÃŠTRE LANCÃ‰!${NC}"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ¯ NEXT STEPS:"
echo "  1. Lire SEEDBAY-README.md"
echo "  2. Suivre les phases d'implÃ©mentation"
echo "  3. Tester avec les 56 security test cases"
echo "  4. DÃ©ployer en production"
echo ""
echo "ğŸ“ Si besoin d'aide:"
echo "  - Relire la documentation pertinente"
echo "  - VÃ©rifier les points critiques dans POINTS-CRITIQUES.md"
echo "  - Checker la checklist dans seedbay-deployment-guide.ts"
echo ""
echo "ğŸš€ BON DÃ‰VELOPPEMENT!"
echo ""
